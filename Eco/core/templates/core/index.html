{% extends "base.html" %}
{% load static %}
{% block title %}Home — EcoInsight Media{% endblock %}

{% block content %}

<div class="hero">
    <div>
        <h1>Fresh Reporting on Sustainability</h1>
        <p>Short, focused articles on renewable energy, climate technology, and environmental action.</p>

        <div style="margin-top:20px; display:flex; gap:20px; flex-wrap:wrap;">
            <div class="stat-box">
                <div class="stat-title">Visitors Today</div>
                <div class="stat-value" id="total-visits">{{ total_visits_today }}</div>
            </div>

            {% if user.is_authenticated %}
            <div class="stat-box">
                <div class="stat-title">You Visited Today</div>
                <div class="stat-value" id="user-visits">{{ user_visits_today }}</div>
            </div>
            {% endif %}
        </div>
    </div>

</div>


<div class="grid">
    {% for article in articles %}
    <article class="card">
        {% if article.cover_image %}
        <img src="{{ article.cover_image.url }}" class="thumb">
        {% else %}
        <img src="{% static 'core/img/placeholder.jpg' %}" class="thumb">
        {% endif %}

        <div class="body">
            <div class="meta">{{ article.publish_date|date:"M j, Y" }} • {{ article.author }}</div>

            <h3 class="title">
                <a href="{% url 'article_detail' slug=article.slug %}">{{ article.title }}</a>
            </h3>

            <p class="excerpt">{{ article.summary|truncatechars:150 }}</p>

            <div class="tags">
                {% if article.tag_list %}
                    {% for t in article.tag_list %}
                        {% if t %}<span class="tag">{{ t }}</span>{% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </article>
    {% endfor %}
</div>


<div style="margin-top:32px;text-align:center;">
    {% if page_obj.has_previous %}
    <a class="btn-ghost" href="?page={{ page_obj.previous_page_number }}">Previous</a>
    {% endif %}

    <span style="margin:0 16px;color:var(--muted);">
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
    <a class="btn-ghost" href="?page={{ page_obj.next_page_number }}">Next</a>
    {% endif %}
</div>

{% endblock %}
